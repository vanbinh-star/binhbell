@inject Radzen.DialogService dialog
@inject NotificationService notificationService
@inject NavigationManager UriHelper
@inject ApiServices apiService
@inject ClientServices client
@using IDC.Frontend.Services.ApiService
@using IDC.Frontend.Services
@using QLCongViec.Components
@using QLCongViec.Models;
@using QLCongViec.Models.HeThong
using QLCongViec.Models.HeThong

<RadzenTemplateForm TItem="tbChucNang" Data="Data" Submit="@(obj => Submit((tbChucNang)obj))">
<div class="row">
<div class="col-12">
<FormField Text="Tên chức năng">
<RadzenTextBox @bind-Value="@Data.TenChucNang"></RadzenTextBox>
</FormField>
<FormField Text="Đường dẫn">
<RadzenTextBox @bind-Value="@Data.DuongDan"></RadzenTextBox>
</FormField>
<FormField Text="Biểu tượng">
<RadzenTextBox @bind-Value="@Data.BieuTuong"></RadzenTextBox>
</FormField>
</div>
</div>
<div style="float: right; margin-top: 10px;">
<RadzenButton Style="margin-right: 10px" ButtonType="ButtonType.Submit">Lưu</RadzenButton>
<RadzenButton ButtonStyle="ButtonStyle.Light" Click="@(() => ReturnChucNang.InvokeAsync(null))">Hủy
</RadzenButton>
</div>
</RadzenTemplateForm>

@code {
[Parameter] public tbChucNang Record { set; get; } = default!;
[Parameter] public EventCallback<tbChucNang> ReturnChucNang { set; get; }
tbChucNang Data;
bool ChucNangCon = false;

protected override async Task OnInitializedAsync()
{
Data = Record;
}

    async Task Submit(tbChucNang obj)
    {
        if (Record.IdChucNang == 0)
        {
            obj.IdChucNang = await client.numServices.GetInt<tbChucNang>();
            obj.STT = await client.numServices.GetInt<tbChucNang>();

            await client.apiSevices.Create<tbChucNang>(obj);
        }
        else
        {
            await client.apiSevices.Update<tbChucNang>(obj);
        }

        await ReturnChucNang.InvokeAsync(obj);
    }

}
